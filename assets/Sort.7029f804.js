import{_ as K,a5 as x,r as f,w as Q,o as Z,b as Y,q as C,s as L,t as p,Y as G,a6 as A,z,A as M,F as X,x as ee,B as te,C as ae,u as ne,a7 as re}from"./index.faca7b04.js";import{api as B}from"./api.9adbb9af.js";var oe=4,ie=.001,le=1e-7,se=10,T=11,w=1/(T-1),ce=typeof Float32Array=="function";function W(a,t){return 1-3*t+3*a}function k(a,t){return 3*t-6*a}function H(a){return 3*a}function b(a,t,e){return((W(t,e)*a+k(t,e))*a+H(t))*a}function D(a,t,e){return 3*W(t,e)*a*a+2*k(t,e)*a+H(t)}function ue(a,t,e,n,d){var c,u,y=0;do u=t+(e-t)/2,c=b(u,n,d)-a,c>0?e=u:t=u;while(Math.abs(c)>le&&++y<se);return u}function ve(a,t,e,n){for(var d=0;d<oe;++d){var c=D(t,e,n);if(c===0)return t;var u=b(t,e,n)-a;t-=u/c}return t}function pe(a){return a}var de=function(t,e,n,d){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===d)return pe;for(var c=ce?new Float32Array(T):new Array(T),u=0;u<T;++u)c[u]=b(u*w,t,n);function y(h){for(var o=0,g=1,S=T-1;g!==S&&c[g]<=h;++g)o+=w;--g;var _=(h-c[g])/(c[g+1]-c[g]),v=o+_*w,m=D(v,t,n);return m>=ie?ve(h,v,t,n):m===0?v:ue(h,o,o+w,t,n)}return function(o){return o===0?0:o===1?1:b(y(o),e,d)}},F="/assets/application.bc4a430e.svg";const fe=a=>(te("data-v-5cbcf3bd"),a=a(),ae(),a),ge=fe(()=>p("div",{class:"toolBox"},null,-1)),me=["src"],_e={class:"description"},he=["onMousedown","onMouseup"],Se=["onTransitionend"],Ee=["src","onError"],ye={class:"description"},Ie=x(),Te={preFetch({currentRoute:a}){B.getTypeList().then(t=>{let e;t.forEach(n=>{e=n.orig_name===a.params.sort?n.type_id:e}),e?B.getApplicationList(e).then(n=>{Ie.appList=n}):a.push("/Error404")})}},ze=Object.assign(Te,{__name:"Sort",setup(a){const t=ne(),e={cardWidth:264,cardHeight:92,verticalPadding:50,horizonPadding:16,gap:32},n=f({originTop:0,targetTop:0,animationId:0}),d=x(),c=f(d.appList),u=f([]),y=f(d.source),h=f(t.params.sort.toString());d.$subscribe((i,l)=>{c.value=JSON.parse(JSON.stringify(l.appList)),o.value&&(u.value=O(c)),h.value=t.params.sort.toString()});const o=f(),g=f(),S=f({container:!0,active:!1,animation:!1}),_=f({coverCard:!0,active:!1,animation:!1}),v=f({position:{left:0,top:0},class:{}}),m=f(0);function V(){u.value=O(c)}window.addEventListener("resize",V);function O(i){let l=i.value,r=o.value.clientWidth;m.value=Math.floor((r+e.gap-e.horizonPadding*2)/(e.cardWidth+e.gap));let E=(r-(e.cardWidth+e.gap)*m.value+e.gap-e.horizonPadding*2)/(m.value+1);return o.value.style.height=`${Math.ceil(l.length/m.value)*(e.cardHeight+e.gap)+e.gap+e.verticalPadding*1.5}px`,l.forEach((s,I)=>{s.position={left:I%m.value*(E+e.gap+e.cardWidth)+e.horizonPadding+E,top:Math.floor(I/m.value)*(e.cardHeight+e.gap)+e.verticalPadding},s.style=`transform:translate(${s.position.left}px,${s.position.top}px)`,s.hasOwnProperty("class")||(s.class={active:!1,animation:!1,appCard:!0,cover:!1}),s.imgSrc=`${y.value}/store/${t.params.sort}/${s.package.replace("+","%2B")}/icon.png`}),l}function R(i,l){let r;const E=l-i,s=de(.25,.1,.25,1);function I(P){r===void 0&&(r=P);const $=(P-r)/600;o.value.parentElement.parentElement.scrollTo(0,i+E*s(Math.min($,1))),$<1?n.value.animationId=requestAnimationFrame(I):n.value.targetTop=0}n.value.animationId=requestAnimationFrame(I)}Q(m,(i,l)=>{cancelAnimationFrame(n.value.animationId);let r=n.value.targetTop?n.value.targetTop:o.value.parentElement.parentElement.scrollTop;n.value.targetTop=(r-e.verticalPadding+o.value.parentElement.parentElement.clientHeight/2)*l/i-o.value.parentElement.parentElement.clientHeight/2+e.verticalPadding,R(o.value.parentElement.parentElement.scrollTop,n.value.targetTop),N(v.value)});function U(i){S.value.active=!0,S.value.animation=!0,v.value.class.cover=!1,i.class.active=!0,i.class.animation=!0,v.value=i,N(v.value)}function j(i){S.value.active=!1,i.class.active=!1,i.class.cover=!0,_.value.active=!0}function q(i,l){l.propertyName==="transform"&&(S.value.animation=!1,i.class.animation=!1)}function N(i){g.value.style=`--j-left:${i.position.left-o.value.clientWidth/2}px;--j-top:${i.position.top-o.value.parentElement.parentElement.clientHeight/2-o.value.parentElement.parentElement.scrollTop}px;`}function J(i){i.propertyName==="transform"&&(_.value.animation=!1,v.value.class.cover=_.value.active)}return Z(()=>{o.value.parentElement.parentElement.addEventListener("scroll",()=>{N(v.value)})}),Y(()=>{d.appList=[]}),(i,l)=>(C(),L("div",{class:M(S.value),ref:r=>{o.value=r}},[p("div",{class:M(_.value),ref:r=>{g.value=r},onClick:l[2]||(l[2]=r=>{_.value.active=!1,_.value.animation=!0})},[p("div",{class:"card",onTransitionend:J},[p("div",{onTransitionend:l[1]||(l[1]=G(()=>{},["stop"]))},[ge,p("img",{src:v.value.imgSrc,alt:"",onError:l[0]||(l[0]=r=>v.value.imgSrc=A(F))},null,40,me),p("div",_e,[p("h6",null,z(v.value.application_name_zh),1),p("p",null,z(v.value.more),1)])],32)],32)],2),(C(!0),L(X,null,ee(u.value,(r,E)=>(C(),L("div",{style:re(r.style),class:M(r.class),key:E,ref_for:!0,ref:s=>{r.el=s},onMousedown:s=>U(r),onMouseup:s=>j(r)},[p("div",{onTransitionend:s=>q(r,s)},[p("img",{src:r.imgSrc,alt:"",onError:s=>r.imgSrc=A(F)},null,40,Ee),p("div",ye,[p("h6",null,z(r.application_name_zh),1),p("p",null,z(r.more),1)])],40,Se)],46,he))),128))],2))}});var Ce=K(ze,[["__scopeId","data-v-5cbcf3bd"]]);export{Ce as default};
