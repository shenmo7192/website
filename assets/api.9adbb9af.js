var K={exports:{}},me=function(e,r){return function(){for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];return e.apply(r,s)}},Le=me,w=Object.prototype.toString;function X(t){return w.call(t)==="[object Array]"}function I(t){return typeof t=="undefined"}function Pe(t){return t!==null&&!I(t)&&t.constructor!==null&&!I(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function Te(t){return w.call(t)==="[object ArrayBuffer]"}function Ue(t){return typeof FormData!="undefined"&&t instanceof FormData}function qe(t){var e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function $e(t){return typeof t=="string"}function De(t){return typeof t=="number"}function ve(t){return t!==null&&typeof t=="object"}function C(t){if(w.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function _e(t){return w.call(t)==="[object Date]"}function Be(t){return w.call(t)==="[object File]"}function ke(t){return w.call(t)==="[object Blob]"}function ye(t){return w.call(t)==="[object Function]"}function Ie(t){return ve(t)&&ye(t.pipe)}function Fe(t){return typeof URLSearchParams!="undefined"&&t instanceof URLSearchParams}function Me(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function He(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function G(t,e){if(!(t===null||typeof t=="undefined"))if(typeof t!="object"&&(t=[t]),X(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function F(){var t={};function e(s,a){C(t[a])&&C(s)?t[a]=F(t[a],s):C(s)?t[a]=F({},s):X(s)?t[a]=s.slice():t[a]=s}for(var r=0,n=arguments.length;r<n;r++)G(arguments[r],e);return t}function Je(t,e,r){return G(e,function(s,a){r&&typeof s=="function"?t[a]=Le(s,r):t[a]=s}),t}function ze(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}var m={isArray:X,isArrayBuffer:Te,isBuffer:Pe,isFormData:Ue,isArrayBufferView:qe,isString:$e,isNumber:De,isObject:ve,isPlainObject:C,isUndefined:I,isDate:_e,isFile:Be,isBlob:ke,isFunction:ye,isStream:Ie,isURLSearchParams:Fe,isStandardBrowserEnv:He,forEach:G,merge:F,extend:Je,trim:Me,stripBOM:ze},S=m;function ee(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var ge=function(e,r,n){if(!r)return e;var s;if(n)s=n(r);else if(S.isURLSearchParams(r))s=r.toString();else{var a=[];S.forEach(r,function(i,p){i===null||typeof i=="undefined"||(S.isArray(i)?p=p+"[]":i=[i],S.forEach(i,function(f){S.isDate(f)?f=f.toISOString():S.isObject(f)&&(f=JSON.stringify(f)),a.push(ee(p)+"="+ee(f))}))}),s=a.join("&")}if(s){var o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e},We=m;function U(){this.handlers=[]}U.prototype.use=function(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};U.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};U.prototype.forEach=function(e){We.forEach(this.handlers,function(n){n!==null&&e(n)})};var Ve=U,Ke=m,Xe=function(e,r){Ke.forEach(e,function(s,a){a!==r&&a.toUpperCase()===r.toUpperCase()&&(e[r]=s,delete e[a])})},be=function(e,r,n,s,a){return e.config=r,n&&(e.code=n),e.request=s,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},Ge=be,we=function(e,r,n,s,a){var o=new Error(e);return Ge(o,r,n,s,a)},Qe=we,Ye=function(e,r,n){var s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):r(Qe("Request failed with status code "+n.status,n.config,null,n.request,n))},N=m,Ze=N.isStandardBrowserEnv()?function(){return{write:function(r,n,s,a,o,u){var i=[];i.push(r+"="+encodeURIComponent(n)),N.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),N.isString(a)&&i.push("path="+a),N.isString(o)&&i.push("domain="+o),u===!0&&i.push("secure"),document.cookie=i.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),et=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},tt=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e},rt=et,nt=tt,st=function(e,r){return e&&!rt(r)?nt(e,r):r},D=m,at=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],it=function(e){var r={},n,s,a;return e&&D.forEach(e.split(`
`),function(u){if(a=u.indexOf(":"),n=D.trim(u.substr(0,a)).toLowerCase(),s=D.trim(u.substr(a+1)),n){if(r[n]&&at.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([s]):r[n]=r[n]?r[n]+", "+s:s}}),r},te=m,ot=te.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function s(a){var o=a;return e&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=s(window.location.href),function(o){var u=te.isString(o)?s(o):o;return u.protocol===n.protocol&&u.host===n.host}}():function(){return function(){return!0}}(),R=m,ut=Ye,ct=Ze,lt=ge,ft=st,ht=it,dt=ot,_=we,re=function(e){return new Promise(function(n,s){var a=e.data,o=e.headers,u=e.responseType;R.isFormData(a)&&delete o["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",y=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(p+":"+y)}var f=ft(e.baseURL,e.url);i.open(e.method.toUpperCase(),lt(f,e.params,e.paramsSerializer),!0),i.timeout=e.timeout;function l(){if(!!i){var b="getAllResponseHeaders"in i?ht(i.getAllResponseHeaders()):null,g=!u||u==="text"||u==="json"?i.responseText:i.response,x={data:g,status:i.status,statusText:i.statusText,headers:b,config:e,request:i};ut(n,s,x),i=null}}if("onloadend"in i?i.onloadend=l:i.onreadystatechange=function(){!i||i.readyState!==4||i.status===0&&!(i.responseURL&&i.responseURL.indexOf("file:")===0)||setTimeout(l)},i.onabort=function(){!i||(s(_("Request aborted",e,"ECONNABORTED",i)),i=null)},i.onerror=function(){s(_("Network Error",e,null,i)),i=null},i.ontimeout=function(){var g="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(g=e.timeoutErrorMessage),s(_(g,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",i)),i=null},R.isStandardBrowserEnv()){var c=(e.withCredentials||dt(f))&&e.xsrfCookieName?ct.read(e.xsrfCookieName):void 0;c&&(o[e.xsrfHeaderName]=c)}"setRequestHeader"in i&&R.forEach(o,function(g,x){typeof a=="undefined"&&x.toLowerCase()==="content-type"?delete o[x]:i.setRequestHeader(x,g)}),R.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),u&&u!=="json"&&(i.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&i.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(g){!i||(i.abort(),s(g),i=null)}),a||(a=null),i.send(a)})},h=m,ne=Xe,pt=be,mt={"Content-Type":"application/x-www-form-urlencoded"};function se(t,e){!h.isUndefined(t)&&h.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function vt(){var t;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(t=re),t}function yt(t,e,r){if(h.isString(t))try{return(e||JSON.parse)(t),h.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}var q={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:vt(),transformRequest:[function(e,r){return ne(r,"Accept"),ne(r,"Content-Type"),h.isFormData(e)||h.isArrayBuffer(e)||h.isBuffer(e)||h.isStream(e)||h.isFile(e)||h.isBlob(e)?e:h.isArrayBufferView(e)?e.buffer:h.isURLSearchParams(e)?(se(r,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):h.isObject(e)||r&&r["Content-Type"]==="application/json"?(se(r,"application/json"),yt(e)):e}],transformResponse:[function(e){var r=this.transitional,n=r&&r.silentJSONParsing,s=r&&r.forcedJSONParsing,a=!n&&this.responseType==="json";if(a||s&&h.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?pt(o,this,"E_JSON_PARSE"):o}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};q.headers={common:{Accept:"application/json, text/plain, */*"}};h.forEach(["delete","get","head"],function(e){q.headers[e]={}});h.forEach(["post","put","patch"],function(e){q.headers[e]=h.merge(mt)});var Q=q,gt=m,bt=Q,wt=function(e,r,n){var s=this||bt;return gt.forEach(n,function(o){e=o.call(s,e,r)}),e},Se=function(e){return!!(e&&e.__CANCEL__)},ae=m,B=wt,St=Se,Et=Q;function k(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var xt=function(e){k(e),e.headers=e.headers||{},e.data=B.call(e,e.data,e.headers,e.transformRequest),e.headers=ae.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),ae.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var r=e.adapter||Et.adapter;return r(e).then(function(s){return k(e),s.data=B.call(e,s.data,s.headers,e.transformResponse),s},function(s){return St(s)||(k(e),s&&s.response&&(s.response.data=B.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},d=m,Ee=function(e,r){r=r||{};var n={},s=["url","method","data"],a=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],u=["validateStatus"];function i(l,c){return d.isPlainObject(l)&&d.isPlainObject(c)?d.merge(l,c):d.isPlainObject(c)?d.merge({},c):d.isArray(c)?c.slice():c}function p(l){d.isUndefined(r[l])?d.isUndefined(e[l])||(n[l]=i(void 0,e[l])):n[l]=i(e[l],r[l])}d.forEach(s,function(c){d.isUndefined(r[c])||(n[c]=i(void 0,r[c]))}),d.forEach(a,p),d.forEach(o,function(c){d.isUndefined(r[c])?d.isUndefined(e[c])||(n[c]=i(void 0,e[c])):n[c]=i(void 0,r[c])}),d.forEach(u,function(c){c in r?n[c]=i(e[c],r[c]):c in e&&(n[c]=i(void 0,e[c]))});var y=s.concat(a).concat(o).concat(u),f=Object.keys(e).concat(Object.keys(r)).filter(function(c){return y.indexOf(c)===-1});return d.forEach(f,p),n};const Ot="axios",At="0.21.4",Nt="Promise based HTTP client for the browser and node.js",Rt="index.js",Ct={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},jt={type:"git",url:"https://github.com/axios/axios.git"},Lt=["xhr","http","ajax","promise","node"],Pt="Matt Zabriskie",Tt="MIT",Ut={url:"https://github.com/axios/axios/issues"},qt="https://axios-http.com",$t={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},Dt={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},_t="dist/axios.min.js",Bt="dist/axios.min.js",kt="./index.d.ts",It={"follow-redirects":"^1.14.0"},Ft=[{path:"./dist/axios.min.js",threshold:"5kB"}];var Mt={name:Ot,version:At,description:Nt,main:Rt,scripts:Ct,repository:jt,keywords:Lt,author:Pt,license:Tt,bugs:Ut,homepage:qt,devDependencies:$t,browser:Dt,jsdelivr:_t,unpkg:Bt,typings:kt,dependencies:It,bundlesize:Ft},xe=Mt,Y={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){Y[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});var ie={},Ht=xe.version.split(".");function Oe(t,e){for(var r=e?e.split("."):Ht,n=t.split("."),s=0;s<3;s++){if(r[s]>n[s])return!0;if(r[s]<n[s])return!1}return!1}Y.transitional=function(e,r,n){var s=r&&Oe(r);function a(o,u){return"[Axios v"+xe.version+"] Transitional option '"+o+"'"+u+(n?". "+n:"")}return function(o,u,i){if(e===!1)throw new Error(a(u," has been removed in "+r));return s&&!ie[u]&&(ie[u]=!0,console.warn(a(u," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(o,u,i):!0}};function Jt(t,e,r){if(typeof t!="object")throw new TypeError("options must be an object");for(var n=Object.keys(t),s=n.length;s-- >0;){var a=n[s],o=e[a];if(o){var u=t[a],i=u===void 0||o(u,a,t);if(i!==!0)throw new TypeError("option "+a+" must be "+i);continue}if(r!==!0)throw Error("Unknown option "+a)}}var zt={isOlderVersion:Oe,assertOptions:Jt,validators:Y},Ae=m,Wt=ge,oe=Ve,ue=xt,$=Ee,Ne=zt,E=Ne.validators;function O(t){this.defaults=t,this.interceptors={request:new oe,response:new oe}}O.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=$(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var r=e.transitional;r!==void 0&&Ne.assertOptions(r,{silentJSONParsing:E.transitional(E.boolean,"1.0.0"),forcedJSONParsing:E.transitional(E.boolean,"1.0.0"),clarifyTimeoutError:E.transitional(E.boolean,"1.0.0")},!1);var n=[],s=!0;this.interceptors.request.forEach(function(l){typeof l.runWhen=="function"&&l.runWhen(e)===!1||(s=s&&l.synchronous,n.unshift(l.fulfilled,l.rejected))});var a=[];this.interceptors.response.forEach(function(l){a.push(l.fulfilled,l.rejected)});var o;if(!s){var u=[ue,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(a),o=Promise.resolve(e);u.length;)o=o.then(u.shift(),u.shift());return o}for(var i=e;n.length;){var p=n.shift(),y=n.shift();try{i=p(i)}catch(f){y(f);break}}try{o=ue(i)}catch(f){return Promise.reject(f)}for(;a.length;)o=o.then(a.shift(),a.shift());return o};O.prototype.getUri=function(e){return e=$(this.defaults,e),Wt(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Ae.forEach(["delete","get","head","options"],function(e){O.prototype[e]=function(r,n){return this.request($(n||{},{method:e,url:r,data:(n||{}).data}))}});Ae.forEach(["post","put","patch"],function(e){O.prototype[e]=function(r,n,s){return this.request($(s||{},{method:e,url:r,data:n}))}});var Vt=O;function Z(t){this.message=t}Z.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Z.prototype.__CANCEL__=!0;var Re=Z,Kt=Re;function L(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(s){e=s});var r=this;t(function(s){r.reason||(r.reason=new Kt(s),e(r.reason))})}L.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};L.source=function(){var e,r=new L(function(s){e=s});return{token:r,cancel:e}};var Xt=L,Gt=function(e){return function(n){return e.apply(null,n)}},Qt=function(e){return typeof e=="object"&&e.isAxiosError===!0},ce=m,Yt=me,j=Vt,Zt=Ee,er=Q;function Ce(t){var e=new j(t),r=Yt(j.prototype.request,e);return ce.extend(r,j.prototype,e),ce.extend(r,e),r}var v=Ce(er);v.Axios=j;v.create=function(e){return Ce(Zt(v.defaults,e))};v.Cancel=Re;v.CancelToken=Xt;v.isCancel=Se;v.all=function(e){return Promise.all(e)};v.spread=Gt;v.isAxiosError=Qt;K.exports=v;K.exports.default=v;var tr=K.exports,rr=tr;/*! Sifrr.Storage v0.0.9 - sifrr project | MIT licensed | https://github.com/sifrr/sifrr */var nr=Object.prototype.toString,P="~SS%l3g5k3~";function sr(t,e){return new Blob([new Uint8Array(t.split(",")).buffer],{type:e})}function ar(t){var e=URL.createObjectURL(t),r=new XMLHttpRequest;r.open("GET",e,!1),r.send(),URL.revokeObjectURL(e);for(var n=new Uint8Array(r.response.length),s=0;s<r.response.length;++s)n[s]=r.response.charCodeAt(s);return n.toString()}function M(t){var e=t;if(typeof t=="string")try{e=t=JSON.parse(t)}catch{}if(typeof t=="string"&&t.indexOf(P)>0){var[r,n,s]=t.split(P);r==="ArrayBuffer"?e=new Uint8Array(n.split(",").map(o=>parseInt(o))).buffer:r==="Blob"?e=sr(s,n):e=new window[r](n.split(","))}else if(Array.isArray(t))e=[],t.forEach((o,u)=>{e[u]=M(o)});else if(typeof t=="object"){if(t===null)return null;e={};for(var a in t)e[a]=M(t[a])}return e}function T(t){if(typeof t!="object")return JSON.stringify(t);if(t===null)return"null";if(Array.isArray(t))return JSON.stringify(t.map(s=>T(s)));var e=nr.call(t).slice(8,-1);if(e==="Object"){var r={};for(var n in t)r[n]=T(t[n]);return JSON.stringify(r)}else e==="ArrayBuffer"?t=new Uint8Array(t):e==="Blob"&&(t=t.type+P+ar(t));return e+P+t.toString()}var le=(t,e)=>{var r=Date.now();return Object.keys(t).forEach(n=>{if(typeof t[n]!="undefined"){var{createdAt:s,ttl:a}=t[n];t[n]=t[n]&&t[n].value,a!==0&&r-s>a&&(delete t[n],e&&e(n))}}),t},fe=(t,e)=>t&&t.value?(t.ttl=t.ttl||e,t.createdAt=Date.now(),t):{value:t,ttl:e,createdAt:Date.now()},ir=(t,e,r)=>{if(typeof t=="string")return{[t]:fe(e,r)};var n={};return Object.keys(t).forEach(s=>n[s]=fe(t[s],r)),n},he=t=>Array.isArray(t)?t:[t],de={name:"SifrrStorage",version:1,description:"Sifrr Storage",size:5*1024*1024,ttl:0};class A{constructor(e=de){this.type=this.constructor.type,this.table={},Object.assign(this,de,e),this.tableName=this.name+this.version}select(e){var r=this.getStore(),n={};return e.forEach(s=>n[s]=r[s]),n}upsert(e){var r=this.getStore();for(var n in e)r[n]=e[n];return this.setStore(r),!0}delete(e){var r=this.getStore();return e.forEach(n=>delete r[n]),this.setStore(r),!0}deleteAll(){return this.setStore({}),!0}getStore(){return this.table}setStore(e){this.table=e}keys(){return Promise.resolve(this.getStore()).then(e=>Object.keys(e))}all(){return Promise.resolve(this.getStore()).then(e=>le(e,this.del.bind(this)))}get(e){return Promise.resolve(this.select(he(e))).then(r=>le(r,this.del.bind(this)))}set(e,r){return Promise.resolve(this.upsert(ir(e,r,this.ttl)))}del(e){return Promise.resolve(this.delete(he(e)))}clear(){return Promise.resolve(this.deleteAll())}memoize(e,r=(...n)=>typeof n[0]=="string"?n[0]:T(n[0])){return(...n)=>{var s=r(...n);return this.get(s).then(a=>{if(a[s]===void 0||a[s]===null){var o=e(...n);if(!(o instanceof Promise))throw Error("Only promise returning functions can be memoized");return o.then(u=>this.set(s,u).then(()=>u))}else return a[s]})}}isSupported(e=!0){return e&&(typeof window=="undefined"||typeof document=="undefined")?!0:!!(window&&this.hasStore())}hasStore(){return!0}isEqual(e){return this.tableName==e.tableName&&this.type==e.type}static stringify(e){return T(e)}static parse(e){return M(e)}static _add(e){this._all=this._all||[],this._all.push(e)}static _matchingInstance(e){for(var r=this._all||[],n=r.length,s=0;s<n;s++)if(r[s].isEqual(e))return r[s];return this._add(e),e}}class H extends A{constructor(e){return super(e),this.constructor._matchingInstance(this)}select(e){var r={},n=[];return e.forEach(s=>n.push(this._tx("readonly","get",s,void 0).then(a=>r[s]=a))),Promise.all(n).then(()=>r)}upsert(e){var r=[];for(var n in e)r.push(this._tx("readwrite","put",e[n],n));return Promise.all(r).then(()=>!0)}delete(e){var r=[];return e.forEach(n=>r.push(this._tx("readwrite","delete",n,void 0))),Promise.all(r).then(()=>!0)}deleteAll(){return this._tx("readwrite","clear",void 0,void 0)}_tx(e,r,n,s){var a=this;return this.store=this.store||this.createStore(a.tableName),this.store.then(o=>new Promise((u,i)=>{var p=o.transaction(a.tableName,e).objectStore(a.tableName),y=p[r].call(p,n,s);y.onsuccess=f=>u(f.target.result),y.onerror=f=>i(f.error)}))}getStore(){return this._tx("readonly","getAllKeys",void 0,void 0).then(this.select.bind(this))}createStore(e){return new Promise((r,n)=>{var s=window.indexedDB.open(e,1);s.onupgradeneeded=()=>{s.result.createObjectStore(e)},s.onsuccess=()=>r(s.result),s.onerror=()=>n(s.error)})}hasStore(){return!!window.indexedDB}static get type(){return"indexeddb"}}class J extends A{constructor(e){return super(e),this.constructor._matchingInstance(this)}parsedData(){}select(e){var r=e.map(()=>"?").join(", ");return this.execSql("SELECT key, value FROM ".concat(this.tableName," WHERE key in (").concat(r,")"),e)}upsert(e){return this.getWebsql().transaction(r=>{for(var n in e)r.executeSql("INSERT OR REPLACE INTO ".concat(this.tableName,"(key, value) VALUES (?, ?)"),[n,this.constructor.stringify(e[n])])}),!0}delete(e){var r=e.map(()=>"?").join(", ");return this.execSql("DELETE FROM ".concat(this.tableName," WHERE key in (").concat(r,")"),e),!0}deleteAll(){return this.execSql("DELETE FROM ".concat(this.tableName)),!0}getStore(){return this.execSql("SELECT key, value FROM ".concat(this.tableName))}hasStore(){return!!window.openDatabase}getWebsql(){return this._store?this._store:(this._store=window.openDatabase("ss",1,this.description,this.size),this.execSql("CREATE TABLE IF NOT EXISTS ".concat(this.tableName," (key unique, value)")),this._store)}execSql(e,r=[]){var n=this;return new Promise(s=>{n.getWebsql().transaction(function(a){a.executeSql(e,r,(o,u)=>{s(n.parseResults(u))})})})}parseResults(e){for(var r={},n=e.rows.length,s=0;s<n;s++)r[e.rows.item(s).key]=this.constructor.parse(e.rows.item(s).value);return r}static get type(){return"websql"}}class z extends A{constructor(e){return super(e),this.constructor._matchingInstance(this)}select(e){var r={};return e.forEach(n=>{var s=this.constructor.parse(this.getLocalStorage().getItem(this.tableName+"/"+n));s!==null&&(r[n]=s)}),r}upsert(e){for(var r in e)this.getLocalStorage().setItem(this.tableName+"/"+r,this.constructor.stringify(e[r]));return!0}delete(e){return e.map(r=>this.getLocalStorage().removeItem(this.tableName+"/"+r)),!0}deleteAll(){return Object.keys(this.getLocalStorage()).forEach(e=>{e.indexOf(this.tableName)===0&&this.getLocalStorage().removeItem(e)}),!0}getStore(){return this.select(Object.keys(this.getLocalStorage()).map(e=>{if(e.indexOf(this.tableName)===0)return e.slice(this.tableName.length+1)}).filter(e=>typeof e!="undefined"))}getLocalStorage(){return window.localStorage}hasStore(){return!!window.localStorage}static get type(){return"localstorage"}}var or=new Date(0).toUTCString(),je="%3D",ur=new RegExp(je,"g");class W extends A{constructor(e){return super(e),this.constructor._matchingInstance(this)}upsert(e){for(var r in e)this.setStore("".concat(this.tableName,"/").concat(r,"=").concat(this.constructor.stringify(e[r]).replace(/=/g,je),"; path=/"));return!0}delete(e){return e.forEach(r=>this.setStore("".concat(this.tableName,"/").concat(r,"=; expires=").concat(or,"; path=/"))),!0}deleteAll(){return this.keys().then(this.delete.bind(this))}getStore(){var e=document.cookie,r={};return e.split("; ").forEach(n=>{var[s,a]=n.split("=");s.indexOf(this.tableName)===0&&(r[s.slice(this.tableName.length+1)]=this.constructor.parse(a.replace(ur,"=")))}),r}setStore(e){document.cookie=e}hasStore(){return typeof document.cookie!="undefined"}static get type(){return"cookies"}}class V extends A{constructor(e){return super(e),this.constructor._matchingInstance(this)}hasStore(){return!0}static get type(){return"jsonstorage"}}var pe={[H.type]:H,[J.type]:J,[z.type]:z,[W.type]:W,[V.type]:V};function cr(t=[],e={}){t=t.concat([H.type,J.type,z.type,W.type,V.type]);for(var r=0;r<t.length;r++){var n=pe[t[r]];if(n){var s=new n(e);if(s.isSupported())return s}}throw Error("No compatible storage found. Available types: "+Object.keys(pe).join(", ")+".")}function lr(t){var e=typeof t=="string"?[t]:(t||{}).priority,r=typeof t=="string"?{}:t;return cr(e,r)}/*! (c) @aadityataparia */let fr={axios:rr.create({baseURL:"https://store.deepinos.org/api/"}),storage:lr({priority:["indexeddb","websql","localstorage"],name:"apiCache",version:1,description:"Cache for Spark Store API",ttl:0}),getTypeList:async function(){try{let t=await this.storage.get("typeList");if(t.typeList)return t.typeList}catch(t){console.error(t)}try{let t=await this.axios.post("/type/get_type_list");return await this.storage.set("typeList",{value:t.data.data,ttl:24*60*60*1e3}),t.data.data}catch(t){console.error(t)}},getApplicationList:async function(t){try{let e=await this.storage.get(`applicationList_${t}`);if(e[`applicationList_${t}`])return e[`applicationList_${t}`]}catch(e){console.error(e)}try{let e=await this.axios.post("/application/get_application_list",{size:1e4,type_id:t});return await this.storage.set(`applicationList_${t}`,{value:e.data.data.data,ttl:10*60*1e3}),e.data.data.data}catch(e){console.error(e)}}};export{fr as api};
